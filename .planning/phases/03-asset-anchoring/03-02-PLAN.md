---
phase: 03-asset-anchoring
plan: 02
type: execute
depends_on: ["03-01"]
files_modified: [src/app/(dashboard)/products/page.tsx, src/app/(dashboard)/products/[id]/page.tsx, src/app/(dashboard)/products/[id]/client.tsx, src/app/(dashboard)/products/new/page.tsx, src/components/product-card.tsx, src/components/image-grid.tsx]
---

<objective>
Create product listing and profile pages with visual-first image gallery design.

Purpose: Enable users to view, upload, and manage product images as the source of truth for AI generation.
Output: Product list page, product profile page with hero + variants gallery, image upload UI.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-asset-anchoring/03-CONTEXT.md
@.planning/phases/03-asset-anchoring/03-01-SUMMARY.md
@.planning/phases/02-brand-ingestion/02-03-SUMMARY.md

**From CONTEXT.md - Vision:**
- Visual grid gallery â€” big thumbnails, minimal chrome
- Hero image + variants grouped per product
- Visual-first design (consistent with Phase 2 brand swatches)

**From CONTEXT.md - Essential:**
- Product fidelity (clear display of actual product images)
- Easy upload workflow (frictionless)
- Clear organization (intuitive navigation)

**Patterns established (from Phase 2):**
- Server Component for initial data fetch, Client Component for interactivity
- Visual-first design: large visual elements dominate
- BrandCard preview pattern
- Drag-and-drop upload page pattern
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create product list page and card component</name>
  <files>src/app/(dashboard)/products/page.tsx, src/components/product-card.tsx</files>
  <action>
1. Create src/components/product-card.tsx:

A card component that shows product preview:
- Product name as title
- Hero image as large thumbnail (w-full aspect-square object-cover)
- Brand name as subtitle (fetch from brand relation or pass as prop)
- Number of images: "5 images"
- Click to navigate to /products/[id]

If no hero image exists, show placeholder with upload icon.

Style: Match Linear aesthetic from Phase 1. White card, subtle shadow, hover state. Image should dominate the card.

2. Create src/app/(dashboard)/products/page.tsx:

Page that lists all products:
- Header: "Products" with "Add Product" button (links to /products/new)
- Optional filter by brand (dropdown or tabs if multiple brands exist)
- Grid of ProductCard components (3 columns on desktop)
- Empty state: "No products yet. Add product images to anchor your AI creatives."
- Fetch products from /api/products

Server Component that fetches data. Use Supabase server client directly (better performance than going through API for reads).

Keep navigation simple - clicking card goes to product detail.
  </action>
  <verify>npm run build succeeds, page renders at /products</verify>
  <done>Product list page shows all products as cards with hero image thumbnails</done>
</task>

<task type="auto">
  <name>Task 2: Create product profile page with image gallery</name>
  <files>src/app/(dashboard)/products/[id]/page.tsx, src/app/(dashboard)/products/[id]/client.tsx, src/components/image-grid.tsx</files>
  <action>
1. Create src/components/image-grid.tsx:

Image gallery component for product images:
- Grid layout (2-3 columns)
- Hero image displayed larger/first with "HERO" badge
- Each image shows:
  - Large thumbnail (h-48 w-full object-cover)
  - Angle label if set
  - "Set as Hero" button (if not hero)
  - Delete button (trash icon)
- Upload zone at end of grid (dashed border, + icon)
- Clicking upload zone opens file picker or drag-and-drop

Props: images[], productId, onUpload(), onDelete(), onSetHero()

2. Create src/app/(dashboard)/products/[id]/page.tsx (Server Component):

Fetches product with images, renders ProductProfileClient.

3. Create src/app/(dashboard)/products/[id]/client.tsx (Client Component):

**Header section:**
- Product name (editable inline)
- Brand name (link to /brands/[brand_id])
- Description (editable)
- SKU (editable)
- Back link to /products

**Images section:**
- "Product Images" header with drag-and-drop hint
- ImageGrid component with all images
- Upload handler: POST to /api/products/[id]/images
- Delete handler: DELETE to /api/products/[id]/images?image_id=X
- Set hero handler: PATCH to update is_hero flags

Upload should:
1. Accept file drop or click
2. Show upload progress (loading state)
3. Refresh images on success
4. Show error on failure

Design: Visual-first. Images are THE focus. Metadata is secondary. Make it feel like a photo library, not a database form.
  </action>
  <verify>npm run build succeeds, page renders at /products/[id]</verify>
  <done>Product profile displays hero + variant images in visual grid, upload/delete works</done>
</task>

<task type="auto">
  <name>Task 3: Create product creation page</name>
  <files>src/app/(dashboard)/products/new/page.tsx</files>
  <action>
Create src/app/(dashboard)/products/new/page.tsx:

Page to create new product:
- Header: "New Product"
- Form fields:
  - Name (required)
  - Brand (dropdown selecting from existing brands)
  - Description (optional textarea)
  - SKU (optional)
- Submit button: "Create Product"
- On success: redirect to /products/[id] where user can immediately upload images

Flow:
1. User fills form
2. POST to /api/products
3. On success: redirect to /products/[id]
4. On error: show error message

Style:
- Simple form, not overwhelming
- Brand dropdown fetches from /api/brands
- Client Component for form handling

Note: This is intentionally simple. The main action happens on the product profile page where images are uploaded. This page just creates the product record to enable that.
  </action>
  <verify>npm run build succeeds, page renders at /products/new</verify>
  <done>Create product page submits form, redirects to profile for image upload</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds
- [ ] /products page lists products with image thumbnails
- [ ] /products/[id] shows product with image gallery
- [ ] /products/new allows creating new products
- [ ] Image upload via drag-and-drop works
- [ ] Set hero and delete image work
- [ ] No TypeScript or ESLint errors
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Products displayed with visual image grid
- Image upload workflow is frictionless
- Hero image clearly distinguished
- Phase 3 complete
</success_criteria>

<output>
After completion, create `.planning/phases/03-asset-anchoring/03-02-SUMMARY.md`

Commit guidance:
- Task 1: `feat(03-02): create product list page and card component`
- Task 2: `feat(03-02): create product profile page with image gallery`
- Task 3: `feat(03-02): create product creation page`
- Metadata: `docs(03-02): complete asset UI plan`

Note: This is the final plan for Phase 3. After SUMMARY.md, update ROADMAP.md and STATE.md to mark Phase 3 complete.
</output>
